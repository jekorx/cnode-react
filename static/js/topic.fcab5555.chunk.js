(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{198:function(e,t,a){"use strict";a(37),a(74),a(201)},199:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(8)),c=h(a(18)),o=h(a(9)),l=h(a(10)),r=h(a(4)),i=h(a(13)),s=h(a(16)),p=h(a(0)),u=h(a(113)),d=h(a(76));function h(e){return e&&e.__esModule?e:{default:e}}var m=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var c=0;for(n=Object.getOwnPropertySymbols(e);c<n.length;c++)t.indexOf(n[c])<0&&(a[n[c]]=e[n[c]])}return a},f=/^[\u4e00-\u9fa5]{2}$/,_=f.test.bind(f);function y(e){return"string"===typeof e}function g(e){return y(e.type)&&_(e.props.children)?p.default.cloneElement(e,{},e.props.children.split("").join(" ")):y(e)?(_(e)&&(e=e.split("").join(" ")),p.default.createElement("span",null,e)):e}var v=function(e){function t(){return(0,o.default)(this,t),(0,r.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,i.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e,t=this.props,a=t.children,o=t.className,l=t.prefixCls,r=t.type,i=t.size,h=t.inline,f=t.disabled,_=t.icon,y=t.loading,v=t.activeStyle,b=t.activeClassName,E=t.onClick,O=m(t,["children","className","prefixCls","type","size","inline","disabled","icon","loading","activeStyle","activeClassName","onClick"]),k=y?"loading":_,j=(0,s.default)(l,o,(e={},(0,c.default)(e,l+"-primary","primary"===r),(0,c.default)(e,l+"-ghost","ghost"===r),(0,c.default)(e,l+"-warning","warning"===r),(0,c.default)(e,l+"-small","small"===i),(0,c.default)(e,l+"-inline",h),(0,c.default)(e,l+"-disabled",f),(0,c.default)(e,l+"-loading",y),(0,c.default)(e,l+"-icon",!!k),e)),w=p.default.Children.map(a,g),C=void 0;if("string"===typeof k)C=p.default.createElement(d.default,{"aria-hidden":"true",type:k,size:"small"===i?"xxs":"md",className:l+"-icon"});else if(k){var N=k.props&&k.props.className,S=(0,s.default)("am-icon",l+"-icon","small"===i?"am-icon-xxs":"am-icon-md");C=p.default.cloneElement(k,{className:N?N+" "+S:S})}return p.default.createElement(u.default,{activeClassName:b||(v?l+"-active":void 0),disabled:f,activeStyle:v},p.default.createElement("a",(0,n.default)({role:"button",className:j},O,{onClick:f?void 0:E,"aria-disabled":f}),C,w))}}]),t}(p.default.Component);v.defaultProps={prefixCls:"am-button",size:"large",inline:!1,disabled:!1,loading:!1,activeStyle:{}},t.default=v,e.exports=t.default},200:function(e,t,a){e.exports={topic:"topic_topic__1IEF2",title:"topic_title__32fJJ","title-wrap":"topic_title-wrap__2P6q7",edit:"topic_edit__1Q2zC",info:"topic_info__KDzu-",avatar:"topic_avatar__3hRtr",center:"topic_center__roHo9",collect:"topic_collect__LW6z8","collect-wrap":"topic_collect-wrap__39Ab_",tag:"topic_tag__3NIzm","tag-author":"topic_tag-author__2txIJ","tag-wrap":"topic_tag-wrap__2hOwd",reply:"topic_reply__34ox1","reply-header":"topic_reply-header__3ezps","reply-count":"topic_reply-count__txn3L","reply-info":"topic_reply-info__a47xY","reply-name":"topic_reply-name__2W-Vi","reply-left":"topic_reply-left__ZG4c-","reply-right":"topic_reply-right__2Fi66","reply-add":"topic_reply-add__1ejKI","reply-icon":"topic_reply-icon__IoA6u",anchor:"topic_anchor__2lRxX",user:"topic_user__1msde","up-count":"topic_up-count__uzWZz",comment:"topic_comment__1SRHB",textarea:"topic_textarea__2kAYB",btns:"topic_btns__1GHMa",btn:"topic_btn__28Nnf"}},201:function(e,t,a){},239:function(e,t,a){"use strict";a.r(t);a(115);var n,c=a(75),o=a.n(c),l=a(25),r=a.n(l),i=a(36),s=(a(116),a(60)),p=a.n(s),u=a(2),d=a(3),h=a(6),m=a(5),f=a(38),_=a(7),y=a(0),g=a.n(y),v=a(15),b=a(196),E=a(50),O=a(77),k=a(78),j=a(32),w=(a(198),a(199)),C=a.n(w),N=a(193),S=a(96),x=a(24),I=(a(114),a(46)),R=a.n(I),T=a(200),z=a.n(T),D=a(79),P=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).state={isCollect:!1},a.handleCollect=function(){var e=a.props,t=e.topic.id,n=e.atk,c=e.history;if(Object(j.a)(n,c)){var o=a.state.isCollect;E.a.post("topic_collect/".concat(o?"de_collect ":"collect "),{accesstoken:n,topic_id:t}).then(function(e){var t=e.success,n=e.error_msg;t?a.setState({isCollect:!o}):R.a.fail(n,1)})}},a}return Object(_.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.setState({isCollect:this.props.topic.is_collect})}},{key:"render",value:function(){var e=this.props.topic,t=this.state.isCollect;return g.a.createElement("section",{className:z.a.info},g.a.createElement(N.a,{to:"/user/".concat(e.author.loginname)},g.a.createElement("span",{className:z.a.avatar,style:{backgroundImage:"url(".concat(e.author.avatar_url,")")}})),g.a.createElement("div",{className:z.a.center},g.a.createElement("span",null,e.author.loginname," \xb7 \u53d1\u5e03\u4e8e ",Object(j.c)(e.create_at)),g.a.createElement("span",null,"\u6765\u81ea ",D[e.tab]," \xb7 ",e.visit_count," \u6b21\u6d4f\u89c8")),g.a.createElement("div",{className:z.a["collect-wrap"]},g.a.createElement(C.a,{inline:!0,size:"small",className:z.a.collect,onClick:this.handleCollect,type:t?"ghost":"primary"},t?"\u53d6\u6d88\u6536\u85cf":"\u6536\u85cf")))}}]),t}(y.PureComponent),M=Object(b.a)(P),q=a(23),A=a.n(q),B=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.cnt;return g.a.createElement("section",{className:["markdown-body",A.a.html].join(" "),dangerouslySetInnerHTML:{__html:e}})}}]),t}(y.PureComponent),H=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).state={content:""},a.handleInput=function(e){var t=e.target;a.setState({content:t.value})},a.handleCommit=function(){var e=a.state.content;if(e){var t=a.props,n=t.atk,c=t.topicId,o=t.replyId,l=t.handleSucc;E.a.post("topic/".concat(c,"/replies"),Object.assign({accesstoken:n,content:e},o?{reply_id:o}:{})).then(function(e){e.success&&(R.a.success("\u56de\u590d\u6210\u529f\uff01",0),a.setState({content:""}),setTimeout(l,1e3))})}else R.a.fail("\u8bf7\u8f93\u5165\u56de\u590d\u5185\u5bb9\uff01",1)},a}return Object(_.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.replayName;e&&this.setState({content:"[@".concat(e,"](/user/").concat(e,") ")})}},{key:"render",value:function(){var e=this.state.content,t=this.props.handleCancel;return g.a.createElement("div",{className:z.a.comment},g.a.createElement("textarea",{placeholder:"\u652f\u6301Markdown\u8bed\u6cd5",className:z.a.textarea,value:e,onChange:this.handleInput}),g.a.createElement("div",{className:z.a.btns},g.a.createElement(C.a,{inline:!0,size:"small",type:"primary",className:z.a.btn,onClick:this.handleCommit},"\u56de\u590d"),t&&g.a.createElement(C.a,{inline:!0,size:"small",type:"ghost",className:z.a.btn,onClick:t},"\u53d6\u6d88")))}}]),t}(y.PureComponent),V=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).state={showComment:!1},a.handleToggleReply=function(){a.setState({showComment:!a.state.showComment})},a.handleSucc=function(){a.handleToggleReply(),a.props.handleSucc()},a}return Object(_.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.topic,a=e.atk,n=e.authorId,c=this.state.showComment;return g.a.createElement("div",{className:z.a.topic},g.a.createElement("h2",{className:z.a["title-wrap"]},(t.good||t.top)&&g.a.createElement("span",{className:z.a["tag-wrap"]},g.a.createElement(S.a,{good:t.good,top:t.top,tab:t.tab,className:z.a.tag})),g.a.createElement("span",{className:z.a.title},t.title),n===t.author_id&&g.a.createElement(N.a,{to:"/edit/".concat(t.id)},g.a.createElement(x.a,{type:"edit",className:z.a.edit}))),t.author&&g.a.createElement(M,{topic:t,atk:a,authorId:n}),g.a.createElement(B,{cnt:t.content}),g.a.createElement("h3",{className:z.a["reply-header"]},g.a.createElement("strong",null,g.a.createElement("span",{className:z.a["reply-count"]},t.reply_count),"\u56de\u590d"),g.a.createElement(C.a,{inline:!0,size:"small",type:"ghost",className:z.a["reply-add"],onClick:this.handleToggleReply},c?"\u53d6\u6d88":"\u6dfb\u52a0\u56de\u590d")),g.a.createElement("div",{style:{display:c?"block":"none"}},g.a.createElement(H,{atk:a,topicId:t.id,handleSucc:this.handleSucc})))}}]),t}(y.Component),G=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).state={uped:!1,count:0},a.handleUp=function(){var e=a.props,t=e.data,n=t.id,c=t.is_uped,o=e.atk,l=e.history;Object(j.a)(o,l)&&E.a.post("reply/".concat(n,"/ups "),{accesstoken:o}).then(function(e){var t=e.success,n=e.action,o=e.error_msg;t?a.setState({uped:"up"===n,count:c?"down"===n?-1:0:"up"===n?1:0}):R.a.fail(o,1)})},a}return Object(_.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.setState({uped:this.props.data.is_uped})}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.rowId,n=e.atk,c=e.topicId,o=e.author,l=e.handleSucc,r=e.handleCancel,i=e.handleReply,s=this.state,p=s.uped,u=s.count;return g.a.createElement("div",{id:t.id,className:z.a.reply},g.a.createElement("section",{className:z.a.user},g.a.createElement(N.a,{to:"/user/".concat(t.author.loginname)},g.a.createElement("span",{className:z.a.avatar,style:{backgroundImage:"url(".concat(t.author.avatar_url,")")}})),g.a.createElement("div",{className:z.a["reply-info"]},g.a.createElement("span",{className:z.a["reply-left"]},g.a.createElement("span",{className:z.a["reply-name"]},t.author.loginname),g.a.createElement("a",{href:"#".concat(t.id),className:z.a.anchor},a," \u697c \xb7 ",Object(j.c)(t.create_at)),t.author.loginname===o&&g.a.createElement("span",{className:z.a["tag-author"]},"\u4f5c\u8005")),g.a.createElement("span",{className:z.a["reply-right"]},g.a.createElement(x.a,{type:p?"uped":"up",className:z.a["reply-icon"],onClick:this.handleUp}),g.a.createElement("span",{className:z.a["up-count"]},t.ups.length+u),g.a.createElement(x.a,{type:"reply",className:z.a["reply-icon"],onClick:i})))),g.a.createElement(B,{cnt:t.content}),t.showComment&&g.a.createElement(H,{atk:n,topicId:c,replyId:t.id,replayName:t.author.loginname,handleSucc:l,handleCancel:r}))}}]),t}(y.PureComponent),J=Object(b.a)(G),W=Object(v.b)("_GV_","user")(n=Object(v.c)(n=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={topic:{},showBackTop:!1,refreshing:!1,list:[],dataSource:new p.a.DataSource({rowHasChanged:function(e,t){return e.id!==t.id||e.showComment!==t.showComment}}),pageSize:14,height:0},a.handleScroll=function(e){a.setState({showBackTop:e.target.scrollTop>200})},a.handleBackTop=function(){a.setState({showBackTop:!1},function(){a.listViewRef.scrollTo(0)})},a.handleRefresh=function(){a.setState({refreshing:!0},a.queryData)},a.handleReply=function(e){var t=a.props,n=t.user.accessToken,c=t.history;if(Object(j.a)(n,c)){var o=a.state.list.map(function(t,a){return Object.assign({},t,a>0&&{showComment:a===+e})});a.setState({dataSource:a.state.dataSource.cloneWithRows(o)})}},a.queryData=a.queryData.bind(Object(f.a)(a)),a}return Object(_.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props._GV_.headerHeight;this.setState({height:(document.documentElement.clientHeight||document.body.clientHeight)-e}),this.queryData()}},{key:"queryData",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,a,n,c,o,l,i,s,p;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.match.params,n=t._GV_.setTitle,c=t.user.accessToken,n({title:""}),e.next=4,E.a.get("topic/".concat(a.id,"?accesstoken=").concat(c));case 4:o=e.sent,l=o.success,i=o.data,l&&(s=Object.assign({},i),p=[s].concat(i.replies),delete s.replies,this.setState({topic:i,refreshing:!1,list:p,dataSource:this.state.dataSource.cloneWithRows(p)}));case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.topic,n=t.showBackTop,c=t.dataSource,l=t.height,r=t.pageSize,i=t.refreshing,s=this.props.user,u=s.accessToken,d=s.id;return g.a.createElement(y.Fragment,null,g.a.createElement(p.a,{ref:function(t){e.listViewRef=t},dataSource:c,pageSize:r,style:{height:l,overflow:"auto"},onScroll:this.handleScroll,scrollEventThrottle:800,scrollRenderAheadDistance:400,pullToRefresh:g.a.createElement(o.a,{refreshing:i,onRefresh:this.handleRefresh,indicator:k.a}),renderRow:function(t,n,c){return 0===+c?g.a.createElement(V,{topic:t,atk:u,authorId:d,handleSucc:e.queryData}):g.a.createElement(J,{key:t.id,rowId:+c,data:t,atk:u,topicId:a.id,author:a.author&&a.author.loginname,handleSucc:e.queryData,handleReply:function(){return e.handleReply(c)},handleCancel:function(){return e.handleReply(-1)}})}}),g.a.createElement(O.a,{show:n,handleClick:this.handleBackTop}))}}]),t}(y.Component))||n)||n,F=Object(b.a)(W);t.default=F}}]);